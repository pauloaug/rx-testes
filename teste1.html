<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>teste com Rx</title>

	<script type="text/javascript" src="d3.min.js"></script>
	<script type="text/javascript" src="Rx.min.js"></script>

</head>

<body>

	<div>
		<svg width="1000" height="800">

		</svg>

	</div>



<script>
	
	const intervalo = Rx.Observable.interval(10);
	const gerador = Rx.Observable.interval(1000).take(10);
	const mouse = Rx.Observable.fromEvent(document, 'mousemove');
	const click = Rx.Observable.fromEvent(document, 'click').map(x=> Math.random() * 100 | 0);
	// const yInicio = Rx.Observable.create()
	
	var color = d3.scaleOrdinal(d3.schemeCategory10);


const visualizer = function(x) {

		var x0 = 900;
		var y0 = 50;
		var grupo = d3.select("svg").append("g")
								.attr("transform", `translate(${x0},${y0})`);

		grupo.append("circle")
			.attr("r", 20)
			.attr("stroke-width", "1")
			.attr("stroke", "black")
			.attr("fill", color(x));
			// .attr("fill", "transparent");

		grupo.append("text")
			.text(x)
			.attr("font-size", "20")
			.attr("dy","0.35em")
			.attr("dx", `${-0.3 * x.toString().length}em`);

		intervalo
			.filter( x => x<1000 )
			.subscribe( d => {
			grupo
			  .attr("transform", function(e){
					return `translate(${x0-d},${y0})`
			  });
		});

		return grupo.node();

	};


// click.do(x=> visualizer(x)).subscribe();
click.subscribe(x=> visualizer(x));


	// // const visualizer = gerador.map( x => {
	// const visualizer = click.map( x => {

	// 	var x0 = 900;
	// 	var y0 = 50;
	// 	var grupo = d3.select("svg").append("g")
	// 							.attr("transform", `translate(${x0},${y0})`);

	// 	grupo.append("circle")
	// 		.attr("r", 20)
	// 		.attr("stroke-width", "1")
	// 		.attr("stroke", "black")
	// 		.attr("fill", color(x));
	// 		// .attr("fill", "transparent");

	// 	grupo.append("text")
	// 		.text(x)
	// 		.attr("font-size", "20")
	// 		.attr("dy","0.35em")
	// 		.attr("dx", `${-0.3 * x.toString().length}em`);

	// 	intervalo
	// 		.filter( x => x<1000 )
	// 		.subscribe( d => {
	// 		grupo
	// 		  .attr("transform", function(e){
	// 				return `translate(${x0-d},${y0})`
	// 		  });
	// 	});

	// 	return grupo.node();
	// });

	// visualizer.subscribe();





</script>
</body>
</html>
